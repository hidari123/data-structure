<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <script>
        // 创建字典的构造函数
        class Dictionay {
            // 字典属性
            constructor() {
                this.items = {}
            }

            // 字典操作方法
            // 在字典中添加键值对
            set(key, value) {
                this.items[key] = value
            }

            // 判断字典中是否有某个key
            has(key) {
                return this.items.hasOwnProperty(key)
            }

            // 从字典中移除元素
            remove(key) {
                // 1.判断字典中是否有这个key
                if (!this.has(key)) return false

                // 2.从字典中删除key
                delete this.items[key]
                return true
            }

            // 根据key去获取value
            get(key) {
                return this.has(key) ? this.items[key] : undefined
            }

            // 获取所有的keys
            keys() {
                return Object.keys(this.items)
            }

            // 获取所有的value
            values() {
                return Object.values(this.items)
            }

            // size方法
            size() {
                return this.keys().length
            }

            // clear方法
            clear() {
                this.items = {}
            }
        }

        // 队列
        class Queue {
            // 属性
            constructor (items) {
                this.items = []
            }
            // 方法
            // enqueue
            enqueue(element) {
                this.items.push(element)
            }
            // dequeue
            dequeue() {
                return this.items.shift()
            }
            // front
            front() {
                return this.items[0]
            }
            // isEmpty
            isEmpty() {
                return this.items.length === 0
            }
            // size
            size() {
                return this.items.length
            }
            // toString
            toString() {
                let resultString = ''
                for (let i = 0; i < this.items.length; i++) {
                    resultString += this.items[i] + ' '
                }
                return resultString
            }
        }

        class Graph {
            constructor() {
                // 属性：顶点（数组），边（字典）
                this.vertexes = []
                this.edges = new Dictionay()
            }
            // 方法
            // 添加
            // 添加顶点
            addVertex(v) {
                this.vertexes.push(v)
                this.edges.set(v, [])
            }
            // 添加边
            addEdge(v1, v2) {
                this.edges.get(v1).push(v2)
                this.edges.get(v2).push(v1)
            }

            // toString
            toString() {
                let resultStr = ''
                // 遍历所有顶点以及顶点对应的边
                for (let i = 0; i < this.vertexes.length; i++) {
                    resultStr += this.vertexes[i] + ' -> '
                    let vEdges = this.edges.get(this.vertexes[i])
                    for (let i = 0; i < vEdges.length; i++) {
                        resultStr += vEdges[i] + ' '
                    }
                    resultStr += '\n'
                }
                return resultStr
            }

            // 遍历
            // 初始化状态颜色
            initializeColor() {
                let colors = []
                for (let i = 0; i < this.vertexes.length; i++) {
                    // 给对象赋值 'white' 属性
                    colors[this.vertexes[i]] = 'white'
                }
                return colors
            }

            // 广度优先搜索
            bfs(initV) {
                let resultStr = ''
                // 初始化颜色
                let colors = this.initializeColor()
                // 创建队列
                let queue = new Queue()
                // 将顶点加入到队列中
                queue.enqueue(initV)
                // 循环从队列中取元素
                while (!queue.isEmpty()) {
                    // 从队列中取出一个顶点
                    let v = queue.dequeue()
                    // 获取和顶点相连的另一个顶点
                    let vList = this.edges.get(v)
                    // 将 v 的颜色设为灰色
                    colors[v] = 'gray'
                    // 遍历左右的顶点，并且加入到队列中
                    for (let i = 0; i < vList.length; i++) {
                        let a = vList[i]
                        if (colors[a] === 'white') {
                            colors[a] = 'gray'
                            queue.enqueue(a)
                        }
                    }
                    resultStr += v + ' '
                    colors[v] = 'black'
                }
                return resultStr
            }

            // 深度优先搜索
            dfs(initV) {
                let arr = []
                // 初始化颜色
                let colors = this.initializeColor()
                // 遍历所有的顶点，开始访问
                for (let i = 0; i < this.vertexes.length; i++) {
                    if (colors[this.vertexes[i]] === 'white') {
                        arr = [...this.dfsVisit(initV, colors)]
                    }
                }
                return arr
            }

            // 深度优先搜索遍历
            dfsVisit(v, colors, resultStr = []) {
                // 1.将v的颜色设置为灰色
                colors[v] = "gray"
                // 2.处理v顶点
                // console.log(resultStr)

                // console.log(resultStr)
                // 3.v的所有邻接顶点的访问
                let vList = this.edges.get(v)
                for (let i = 0; i < vList.length; i++) {
                    let a = vList[i]
                    if (colors[a] === 'white') {
                        this.dfsVisit(a, colors)
                    }
                }
                // 4.将v设置为黑色
                colors[v] = "black"
                resultStr.push(v)
                console.log(resultStr)
                return resultStr
            }
        }

        // 测试代码
        let graph = new Graph();

        // 添加顶点
        let myVertexes = ["A", "B", "C", "D", "E", "F", "G", "H", "I"];
        for (let i = 0; i < myVertexes.length; i++) {
            graph.addVertex(myVertexes[i])
        }

        // 添加边
        graph.addEdge('A', 'B');
        graph.addEdge('A', 'C');
        graph.addEdge('A', 'D');
        graph.addEdge('C', 'D');
        graph.addEdge('C', 'G');
        graph.addEdge('D', 'G');
        graph.addEdge('D', 'H');
        graph.addEdge('B', 'E');
        graph.addEdge('B', 'F');
        graph.addEdge('E', 'I');
        console.log(graph.toString())
        console.log(graph.bfs(graph.vertexes[0]))
        console.log(graph.dfs(graph.vertexes[0]))
    </script>
</body>
</html>
